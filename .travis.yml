---
language: bash

# Tell Travis to start Docker when it brings up an environment.
services:
  - docker

env:
  global:
    - DOCKER_REPO=turgon37/transmission
    - secure: 'LRpfmKFY9pBD35dHl1bKscXojV3albq+TZfbBJDMcTHwbyJ4s9JklHIS525ZZWxwu8EITKfr9NFV0WuBDKMMvcjGgWTs6GDIXcKREJL28RhKN6rmC5CpMILv9tIZpKThDqbT3T6ScfXE4g2XAvMT43S/2wQ1dt5pUryWIq8Nx4YXNnUgobt9UNqXuRoAPWmviiycUvxDaUD4gixJfDLp7IvGwSqqu7ZUCPlGKMiaMxAwvSlfKMJG3Fyq4vdgeltpPN1RC9XVUKs9ac55lpWcrFm3mCs+aVAe+fpaXzIOlBlmW0W8xXs0Q4u4v5SAuyimMcjbC05KyaRsA+8jGGcKeTcsFjIVtJOUKShdmxdtuobNuDr06fXXHgKdg08XeayDbbaikODgPBbTR+VDTXUBBnWx/GM18B0M925CoXSRN4Oy2HPqOBEnprKGz1LlsOfX2OHpjY/dbLsStZ48Jf05u7K9xqwVEXRnTy2LnURNpub+4hg042amizhF7oSxuSMDP/eItpnIn3MI3z6UgDbBJF5cmh4renclPTsKnljiOkmxILgowDhPpJHXzknEuiG3HHbtT5i306bQHj8fEBmaWioCMU7v7UtulTWbzsHGfkpBrWhfHI/61DW/iofGaQ7kmHjXbOosPZUVSo+GJEaoqHCaLO314Z3SFDmZFPYN1+Y='
    - secure: 'j1416qjCFiUXzGbJt0aZmq63zqCAx0gFBoCZKIVpB0ZDwAUDiuxxloV3RqJFgcefgYWSRJA8xeQ/4KBJNtYsGOkTYZn3h0BS0yZE2EOhX8VefS6s4hqEZqniHdGapfIovoy5KJBffcjhd8BeL+udUe+19o6YLX/WSPyTOcBo+iWxLJEtJKz3qy2Kpj3FbgcN7uPpLb+jZ5IcxymaPcQsroP8czr16kWYaqMqBTkQfkPKXTImw8py+TMOSXKPx3Xtn1wNWYgV3rd97ARDubsIqnHAvfV6B0gKqBhKvRLIjBOiix/6iLbJ+FRkZUzAAKkaN5pA6lFji/xVW2GSJ+eiqYfjWKy9/sudFYO6i5TovmmBXIdTcdf+prgLNM2PCGk9nJn5FA3Y2whxnBduCFecZFLpIX1bR1jbcBEMvQlhUu8VoR+I0saqA6B7LG36qJwbnXOYwAudTNx/0eWctGXz61RHYjAk/9EaNetDUAW5XVS0GCOsRFCeyQ33yGQc0Uh/uOikC0mTXEbmt2ERDiT/JmIu4yJ0LStDgEi10Qmhv6sWcZ2WBhg1ij+LVugux8ueRNIFotGyNRCDE0XtHs0dvL0zofywgR4njsgwDQQU3kL1lNjNcL4xsn+dN1iPt/Uwn7+5v/aw3u5qW4Ai/w/davyOO9M3Irgt++8d8hp6Iy4='
  matrix:
    # Provide a list of transmission version to build
    - TRANSMISSION_VERSION=""

script:
  #
  ## Build
  #
  - ./build.sh

  #
  ## Run tests
  #
  - ./tests.sh && touch _test_ok

  #
  ## Publish
  #
  - '[ "$TRAVIS_PULL_REQUEST" == "false" ] || exit 0'
  - '[ "$TRAVIS_SECURE_ENV_VARS" == "true" -a -f _test_ok ] && ./publish.sh'
